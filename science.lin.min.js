function science_lin_decomposeTred2(a,b,c){var d=c.length;for(var e=0;e<d;e++)a[e]=c[d-1][e];for(var f=d-1;f>0;f--){var g=0,h=0;for(var i=0;i<f;i++)g+=Math.abs(a[i]);if(g===0){b[f]=a[f-1];for(var e=0;e<f;e++)a[e]=c[f-1][e],c[f][e]=0,c[e][f]=0}else{for(var i=0;i<f;i++)a[i]/=g,h+=a[i]*a[i];var j=a[f-1],k=Math.sqrt(h);j>0&&(k=-k),b[f]=g*k,h-=j*k,a[f-1]=j-k;for(var e=0;e<f;e++)b[e]=0;for(var e=0;e<f;e++){j=a[e],c[e][f]=j,k=b[e]+c[e][e]*j;for(var i=e+1;i<=f-1;i++)k+=c[i][e]*a[i],b[i]+=c[i][e]*j;b[e]=k}j=0;for(var e=0;e<f;e++)b[e]/=h,j+=b[e]*a[e];var l=j/(h+h);for(var e=0;e<f;e++)b[e]-=l*a[e];for(var e=0;e<f;e++){j=a[e],k=b[e];for(var i=e;i<=f-1;i++)c[i][e]-=j*b[i]+k*a[i];a[e]=c[f-1][e],c[f][e]=0}}a[f]=h}for(var f=0;f<d-1;f++){c[d-1][f]=c[f][f],c[f][f]=1;var h=a[f+1];if(h!=0){for(var i=0;i<=f;i++)a[i]=c[i][f+1]/h;for(var e=0;e<=f;e++){var k=0;for(var i=0;i<=f;i++)k+=c[i][f+1]*c[i][e];for(var i=0;i<=f;i++)c[i][e]-=k*a[i]}}for(var i=0;i<=f;i++)c[i][f+1]=0}for(var e=0;e<d;e++)a[e]=c[d-1][e],c[d-1][e]=0;c[d-1][d-1]=1,b[0]=0}function science_lin_decomposeTql2(a,b,c){var d=c.length;for(var e=1;e<d;e++)b[e-1]=b[e];b[d-1]=0;var f=0,g=0,h=1e-12;for(var i=0;i<d;i++){g=Math.max(g,Math.abs(a[i])+Math.abs(b[i]));var j=i;while(j<d){if(Math.abs(b[j])<=h*g)break;j++}if(j>i){var k=0;do{k++;var l=a[i],m=(a[i+1]-l)/(2*b[i]),n=science.hypot(m,1);m<0&&(n=-n),a[i]=b[i]/(m+n),a[i+1]=b[i]*(m+n);var o=a[i+1],p=l-a[i];for(var e=i+2;e<d;e++)a[e]-=p;f+=p,m=a[j];var q=1,r=q,s=q,t=b[i+1],u=0,v=0;for(var e=j-1;e>=i;e--){s=r,r=q,v=u,l=q*b[e],p=q*m,n=science.hypot(m,b[e]),b[e+1]=u*n,u=b[e]/n,q=m/n,m=q*a[e]-u*l,a[e+1]=p+u*(q*l+u*a[e]);for(var w=0;w<d;w++)p=c[w][e+1],c[w][e+1]=u*c[w][e]+q*p,c[w][e]=q*c[w][e]-u*p}m=-u*v*s*t*b[i]/o,b[i]=u*m,a[i]=q*m}while(Math.abs(b[i])>h*g)}a[i]=a[i]+f,b[i]=0}for(var e=0;e<d-1;e++){var w=e,m=a[e];for(var x=e+1;x<d;x++)a[x]<m&&(w=x,m=a[x]);if(w!=e){a[w]=a[e],a[e]=m;for(var x=0;x<d;x++)m=c[x][e],c[x][e]=c[x][w],c[x][w]=m}}}function science_lin_decomposeOrthes(a,b){var c=a.length,d=[],e=0,f=c-1;for(var g=e+1;g<f;g++){var h=0;for(var i=g;i<=f;i++)h+=Math.abs(a[i][g-1]);if(h!==0){var j=0;for(var i=f;i>=g;i--)d[i]=a[i][g-1]/h,j+=d[i]*d[i];var k=Math.sqrt(j);d[g]>0&&(k=-k),j-=d[g]*k,d[g]=d[g]-k;for(var l=g;l<c;l++){var m=0;for(var i=f;i>=g;i--)m+=d[i]*a[i][l];m/=j;for(var i=g;i<=f;i++)a[i][l]-=m*d[i]}for(var i=0;i<=f;i++){var m=0;for(var l=f;l>=g;l--)m+=d[l]*a[i][l];m/=j;for(var l=g;l<=f;l++)a[i][l]-=m*d[l]}d[g]=h*d[g],a[g][g-1]=h*k}}for(var i=0;i<c;i++)for(var l=0;l<c;l++)b[i][l]=i===l?1:0;for(var g=f-1;g>=e+1;g--)if(a[g][g-1]!==0){for(var i=g+1;i<=f;i++)d[i]=a[i][g-1];for(var l=g;l<=f;l++){var k=0;for(var i=g;i<=f;i++)k+=d[i]*b[i][l];k=k/d[g]/a[g][g-1];for(var i=g;i<=f;i++)b[i][l]+=k*d[i]}}}function science_lin_decomposeHqr2(a,b,c,d){var e=c.length,f=e-1,g=0,h=e-1,i=1e-12,j=0,k=0,l=0,m=0,n=0,o=0,p,q,r,s,t=0;for(var u=0;u<e;u++){if(u<g||u>h)a[u]=c[u][u],b[u]=0;for(var v=Math.max(u-1,0);v<e;v++)t+=Math.abs(c[u][v])}var w=0;while(f>=g){var x=f;while(x>g){n=Math.abs(c[x-1][x-1])+Math.abs(c[x][x]),n===0&&(n=t);if(Math.abs(c[x][x-1])<i*n)break;x--}if(x===f)c[f][f]=c[f][f]+j,a[f]=c[f][f],b[f]=0,f--,w=0;else if(x===f-1){q=c[f][f-1]*c[f-1][f],k=(c[f-1][f-1]-c[f][f])/2,l=k*k+q,o=Math.sqrt(Math.abs(l)),c[f][f]=c[f][f]+j,c[f-1][f-1]=c[f-1][f-1]+j,r=c[f][f];if(l>=0){o=k+(k>=0?o:-o),a[f-1]=r+o,a[f]=a[f-1],o!==0&&(a[f]=r-q/o),b[f-1]=0,b[f]=0,r=c[f][f-1],n=Math.abs(r)+Math.abs(o),k=r/n,l=o/n,m=Math.sqrt(k*k+l*l),k/=m,l/=m;for(var v=f-1;v<e;v++)o=c[f-1][v],c[f-1][v]=l*o+k*c[f][v],c[f][v]=l*c[f][v]-k*o;for(var u=0;u<=f;u++)o=c[u][f-1],c[u][f-1]=l*o+k*c[u][f],c[u][f]=l*c[u][f]-k*o;for(var u=g;u<=h;u++)o=d[u][f-1],d[u][f-1]=l*o+k*d[u][f],d[u][f]=l*d[u][f]-k*o}else a[f-1]=r+k,a[f]=r+k,b[f-1]=o,b[f]=-o;f-=2,w=0}else{r=c[f][f],s=0,q=0,x<f&&(s=c[f-1][f-1],q=c[f][f-1]*c[f-1][f]);if(w==10){j+=r;for(var u=g;u<=f;u++)c[u][u]-=r;n=Math.abs(c[f][f-1])+Math.abs(c[f-1][f-2]),r=s=.75*n,q=-0.4375*n*n}if(w==30){n=(s-r)/2,n=n*n+q;if(n>0){n=Math.sqrt(n),s<r&&(n=-n),n=r-q/((s-r)/2+n);for(var u=g;u<=f;u++)c[u][u]-=n;j+=n,r=s=q=.964}}w++;var y=f-2;while(y>=x){o=c[y][y],m=r-o,n=s-o,k=(m*n-q)/c[y+1][y]+c[y][y+1],l=c[y+1][y+1]-o-m-n,m=c[y+2][y+1],n=Math.abs(k)+Math.abs(l)+Math.abs(m),k/=n,l/=n,m/=n;if(y==x)break;if(Math.abs(c[y][y-1])*(Math.abs(l)+Math.abs(m))<i*Math.abs(k)*(Math.abs(c[y-1][y-1])+Math.abs(o)+Math.abs(c[y+1][y+1])))break;y--}for(var u=y+2;u<=f;u++)c[u][u-2]=0,u>y+2&&(c[u][u-3]=0);for(var z=y;z<=f-1;z++){var A=z!=f-1;z!=y&&(k=c[z][z-1],l=c[z+1][z-1],m=A?c[z+2][z-1]:0,r=Math.abs(k)+Math.abs(l)+Math.abs(m),r!=0&&(k/=r,l/=r,m/=r));if(r==0)break;n=Math.sqrt(k*k+l*l+m*m),k<0&&(n=-n);if(n!=0){z!=y?c[z][z-1]=-n*r:x!=y&&(c[z][z-1]=-c[z][z-1]),k+=n,r=k/n,s=l/n,o=m/n,l/=k,m/=k;for(var v=z;v<e;v++)k=c[z][v]+l*c[z+1][v],A&&(k+=m*c[z+2][v],c[z+2][v]=c[z+2][v]-k*o),c[z][v]=c[z][v]-k*r,c[z+1][v]=c[z+1][v]-k*s;for(var u=0;u<=Math.min(f,z+3);u++)k=r*c[u][z]+s*c[u][z+1],A&&(k+=o*c[u][z+2],c[u][z+2]=c[u][z+2]-k*m),c[u][z]=c[u][z]-k,c[u][z+1]=c[u][z+1]-k*l;for(var u=g;u<=h;u++)k=r*d[u][z]+s*d[u][z+1],A&&(k+=o*d[u][z+2],d[u][z+2]=d[u][z+2]-k*m),d[u][z]=d[u][z]-k,d[u][z+1]=d[u][z+1]-k*l}}}}if(t==0)return;for(f=e-1;f>=0;f--){k=a[f],l=b[f];if(l==0){var x=f;c[f][f]=1;for(var u=f-1;u>=0;u--){q=c[u][u]-k,m=0;for(var v=x;v<=f;v++)m+=c[u][v]*c[v][f];if(b[u]<0)o=q,n=m;else{x=u,b[u]===0?c[u][f]=-m/(q!==0?q:i*t):(r=c[u][u+1],s=c[u+1][u],l=(a[u]-k)*(a[u]-k)+b[u]*b[u],p=(r*n-o*m)/l,c[u][f]=p,Math.abs(r)>Math.abs(o)?c[u+1][f]=(-m-q*p)/r:c[u+1][f]=(-n-s*p)/o),p=Math.abs(c[u][f]);if(i*p*p>1)for(var v=u;v<=f;v++)c[v][f]=c[v][f]/p}}}else if(l<0){var x=f-1;if(Math.abs(c[f][f-1])>Math.abs(c[f-1][f]))c[f-1][f-1]=l/c[f][f-1],c[f-1][f]=-(c[f][f]-k)/c[f][f-1];else{var B=science_lin_decomposeCdiv(0,-c[f-1][f],c[f-1][f-1]-k,l);c[f-1][f-1]=B[0],c[f-1][f]=B[1]}c[f][f-1]=0,c[f][f]=1;for(var u=f-2;u>=0;u--){var C=0,D=0,E,F;for(var v=x;v<=f;v++)C+=c[u][v]*c[v][f-1],D+=c[u][v]*c[v][f];q=c[u][u]-k;if(b[u]<0)o=q,m=C,n=D;else{x=u;if(b[u]==0){var B=science_lin_decomposeCdiv(-C,-D,q,l);c[u][f-1]=B[0],c[u][f]=B[1]}else{r=c[u][u+1],s=c[u+1][u],E=(a[u]-k)*(a[u]-k)+b[u]*b[u]-l*l,F=(a[u]-k)*2*l,E==0&F==0&&(E=i*t*(Math.abs(q)+Math.abs(l)+Math.abs(r)+Math.abs(s)+Math.abs(o)));var B=science_lin_decomposeCdiv(r*m-o*C+l*D,r*n-o*D-l*C,E,F);c[u][f-1]=B[0],c[u][f]=B[1];if(Math.abs(r)>Math.abs(o)+Math.abs(l))c[u+1][f-1]=(-C-q*c[u][f-1]+l*c[u][f])/r,c[u+1][f]=(-D-q*c[u][f]-l*c[u][f-1])/r;else{var B=science_lin_decomposeCdiv(-m-s*c[u][f-1],-n-s*c[u][f],o,l);c[u+1][f-1]=B[0],c[u+1][f]=B[1]}}p=Math.max(Math.abs(c[u][f-1]),Math.abs(c[u][f]));if(i*p*p>1)for(var v=u;v<=f;v++)c[v][f-1]=c[v][f-1]/p,c[v][f]=c[v][f]/p}}}}for(var u=0;u<e;u++)if(u<g||u>h)for(var v=u;v<e;v++)d[u][v]=c[u][v];for(var v=e-1;v>=g;v--)for(var u=g;u<=h;u++){o=0;for(var z=g;z<=Math.min(v,h);z++)o+=d[u][z]*c[z][v];d[u][v]=o}}function science_lin_decomposeCdiv(a,b,c,d){if(Math.abs(c)>Math.abs(d)){var e=d/c,f=c+e*d;return[(a+e*b)/f,(b-e*a)/f]}var e=c/d,f=d+e*c;return[(e*a+b)/f,(e*b-a)/f]}science.lin={},science.lin.decompose=function(){function a(a){var b=a.length,c=[],d=[],e=[];for(var f=0;f<b;f++)c[f]=[],d[f]=[],e[f]=[];var g=!0;for(var h=0;h<b;h++)for(var f=0;f<b;f++)if(a[f][h]!==a[h][f]){g=!1;break}if(g){for(var f=0;f<b;f++)c[f]=a[f].slice();science_lin_decomposeTred2(d,e,c),science_lin_decomposeTql2(d,e,c)}else{var i=[];for(var f=0;f<b;f++)i[f]=a[f].slice();science_lin_decomposeOrthes(i,c),science_lin_decomposeHqr2(d,e,i,c)}var j=[];for(var f=0;f<b;f++){var k=j[f]=[];for(var h=0;h<b;h++)k[h]=f===h?d[f]:0;j[f][e[f]>0?f+1:f-1]=e[f]}return{D:j,V:c}}return a},science.lin.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},science.lin.dot=function(a,b){var c=0,d=-1,e=Math.min(a.length,b.length);while(++d<e)c+=a[d]*b[d];return c},science.lin.length=function(a){return Math.sqrt(science.lin.dot(a,a))},science.lin.normalize=function(a){var b=science.lin.length(a);return a.map(function(a){return a/b})},science.lin.determinant=function(a){var b=a[0].concat(a[1]).concat(a[2]).concat(a[3]);return b[12]*b[9]*b[6]*b[3]-b[8]*b[13]*b[6]*b[3]-b[12]*b[5]*b[10]*b[3]+b[4]*b[13]*b[10]*b[3]+b[8]*b[5]*b[14]*b[3]-b[4]*b[9]*b[14]*b[3]-b[12]*b[9]*b[2]*b[7]+b[8]*b[13]*b[2]*b[7]+b[12]*b[1]*b[10]*b[7]-b[0]*b[13]*b[10]*b[7]-b[8]*b[1]*b[14]*b[7]+b[0]*b[9]*b[14]*b[7]+b[12]*b[5]*b[2]*b[11]-b[4]*b[13]*b[2]*b[11]-b[12]*b[1]*b[6]*b[11]+b[0]*b[13]*b[6]*b[11]+b[4]*b[1]*b[14]*b[11]-b[0]*b[5]*b[14]*b[11]-b[8]*b[5]*b[2]*b[15]+b[4]*b[9]*b[2]*b[15]+b[8]*b[1]*b[6]*b[15]-b[0]*b[9]*b[6]*b[15]-b[4]*b[1]*b[10]*b[15]+b[0]*b[5]*b[10]*b[15]},science.lin.gaussjordan=function(a,b){b||(b=1e-10);var c=a.length,d=a[0].length,e=-1,f,g;while(++e<c){var h=e;f=e;while(++f<c)Math.abs(a[f][e])>Math.abs(a[h][e])&&(h=f);var i=a[e];a[e]=a[h],a[h]=i;if(Math.abs(a[e][e])<=b)return!1;f=e;while(++f<c){var j=a[f][e]/a[e][e];g=e-1;while(++g<d)a[f][g]-=a[e][g]*j}}e=c;while(--e>=0){var j=a[e][e];f=-1;while(++f<e){g=d;while(--g>=e)a[f][g]-=a[e][g]*a[f][e]/j}a[e][e]/=j,g=c-1;while(++g<d)a[e][g]/=j}return!0},science.lin.inverse=function(a){var b=a.length,c=-1;if(b!==a[0].length)return;a=a.map(function(a,c){var d=new Array(b),e=-1;while(++e<b)d[e]=c===e?1:0;return a.concat(d)}),science.lin.gaussjordan(a);while(++c<b)a[c]=a[c].slice(b);return a},science.lin.multiply=function(a,b){var c=a.length,d=b[0].length,e=b.length,f=-1,g,h;if(e!==a[0].length)throw{error:"columns(a) != rows(b); "+a[0].length+" != "+e};var i=new Array(c);while(++f<c){i[f]=new Array(d),g=-1;while(++g<d){var j=0;h=-1;while(++h<e)j+=a[f][h]*b[h][g];i[f][g]=j}}return i},science.lin.transpose=function(a){var b=a.length,c=a[0].length,d=-1,e,f=new Array(c);while(++d<c){f[d]=new Array(b),e=-1;while(++e<b)f[d][e]=a[e][d]}return f},science.lin.tridag=function(a,b,c,d,e,f){var g,h;for(g=1;g<f;g++)h=a[g]/b[g-1],b[g]-=h*c[g-1],d[g]-=h*d[g-1];e[f-1]=d[f-1]/b[f-1];for(g=f-2;g>=0;g--)e[g]=(d[g]-c[g]*e[g+1])/b[g]};